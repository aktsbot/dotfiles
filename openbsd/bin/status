#!/bin/sh

sep="|"
bat_ac_stat="$(apm -a)"
bat_stat="$(apm -b)"
bat_perc="$(apm -l)"
cpu_temp="$(sysctl hw.sensors.cpu0.temp0 | cut -d= -f 2 | cut -d. -f 1)"
date="$(date '+%a %b %d %H:%M')"

# convert statuses into shit I can understand
# man 8 apm
case "$bat_stat" in
	0) bat_stat="high" ;;
	1) bat_stat="low" ;;
	2) bat_stat="critical" ;;
	3) bat_stat="charging" ;;
	4) bat_stat="absent" ;;
	*) bat_stat="unknown" ;;
esac

case "$bat_ac_stat" in
        0) bat_ac_stat="disconnected" ;;
        1) bat_ac_stat="connected" ;;
        2) bat_ac_stat="backup" ;;
        *) bat_ac_stat="unknown" ;;
esac

echo "cpu: $cpu_temp C $sep bat: $bat_ac_stat $bat_stat $bat_perc% $sep date: $date "
